<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz de Sistemas Operativos</title>
    <style>
        body {
            margin: 0;
            min-height: 100vh;
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            padding: 20px;
        }
        .card-quiz {
            background: white;
            padding: 30px;
            border-radius: 25px;
            text-align: center;
            width: 100%;
            max-width: 380px;
            height: auto; 
            display: flex;
            flex-direction: column;
            box-shadow: 0 15px 35px rgba(0,0,0,0.4);
            box-sizing: border-box;
        }

        h2 {
            color: #ff4d6d;
            margin: 0 0 15px 0;
            font-size: 1.5rem;
        }

        #info-max {
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 10px;
            color: #333;
            font-weight: 600;
        }

        .config-group {
            margin-bottom: 20px;
        }

        #options-container {
            display: grid;
            gap: 12px;
            margin-top: 20px;
        }

        .button-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 10px;
        }

        input[type="number"] {
            width: 80px;
            padding: 10px;
            border: 2px solid #845ec2;
            border-radius: 12px;
            text-align: center;
            font-size: 1.1rem;
            font-weight: bold;
            outline: none;
        }

        button {
            width: 100%;
            padding: 14px;
            border: none;
            border-radius: 50px;
            font-size: 15px;
            font-weight: bold;
            color: white;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        button:hover {
            transform: translateY(-2px);
            filter: brightness(1.1);
        }

        button:active {
            transform: translateY(0);
        }

        .opcion-btn {
            background: #845ec2;
        }

        .btn-enviar {
            background: #00c9a7;
        }

        .btn-volver {
            background: #2a84d3;
        }

        .header-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            font-weight: bold;
            color: #845ec2;
            font-size: 0.9rem;
        }

        #pregunta-texto {
            font-size: 1.1rem;
            color: #2c3e50;
            line-height: 1.4;
            margin: 10px 0;
            text-align: left;
        }

        #repaso-container {
            text-align: left;
            background: #f8f9fa;
            border-radius: 15px;
            padding: 15px;
            margin: 20px 0;
            max-height: 250px; 
            overflow-y: auto;
            border: 1px solid #eeeeee;
        }

        #repaso-container div {
            font-size: 0.85rem;
            line-height: 1.3;
            margin-bottom: 10px;
            border-bottom: 1px solid #ddd;
            padding-bottom: 5px;
        }

        #repaso-container::-webkit-scrollbar {
            width: 6px;
        }
        #repaso-container::-webkit-scrollbar-thumb {
            background: #ccc;
            border-radius: 10px;
        }
    </style>
</head>
<body>

    <div class="card-quiz">
        <div id="config-area">
            <h2>Sistemas operativos</h2>
            <p id="info-max">Cargando preguntas...</p>
            
            <div class="config-group">
                <label for="num-preguntas">Preguntas a responder:</label>
                <input type="number" id="num-preguntas" value="10" min="5">
            </div>
            
            <div class="button-group">
                <button onclick="prepararQuiz()" class="btn-enviar">¡Empezar!</button>
            </div>
        </div>

        <div id="game-area" style="display: none;">
            <div class="header-info">
                <span id="timer">30s</span>
                <span id="progress">1/10</span>
            </div>
            <div id="pregunta-texto">Cargando...</div>
            <div id="options-container"></div>
        </div>

        <div id="result-area" style="display: none;">
            <h2>Resultados</h2>
            <p id="puntaje-texto" style="font-weight: bold; font-size: 1.2rem;"></p>
            <div id="repaso-container"></div>
            <div class="button-group">
                <button onclick="location.reload()" class="btn-volver">Reiniciar</button>
            </div>
        </div>
    </div>

    <script>
        let historial = []; 
        const bancoPreguntas = [
            // --- MÓDULO 1: INTRODUCCIÓN Y ARQUITECTURA ---
            { tipo: 'cerrada', q: "¿Según L.A. Red Martínez, qué es un Sistema Operativo?", opciones: ["Un programa para navegar por internet.", "Un conjunto de programas de proceso con las rutinas de control necesarias para administrar y gestionar los recursos de manera continua.", "El hardware físico de la computadora.", "Un lenguaje de programación de bajo nivel."], correcta: "Un conjunto de programas de proceso con las rutinas de control necesarias para administrar y gestionar los recursos de manera continua." },
            { tipo: 'cerrada', q: "¿Quién define al SO como un programa que controla la ejecución de aplicaciones y actúa como interfaz usuario-hardware?", opciones: ["Bill Gates.", "L.A. Red Martínez.", "William Stallings.", "Linus Torvalds."], correcta: "William Stallings." },
            { tipo: 'cerrada', q: "¿Cuál es la 'Misión Principal' del SO?", opciones: ["Ejecutar videojuegos con alto rendimiento.", "Asegurar un reparto ordenado y controlado de los procesadores, las memorias y los dispositivos de E/S.", "Eliminar la necesidad de usar una terminal.", "Conectar la computadora a una red local."], correcta: "Asegurar un reparto ordenado y controlado de los procesadores, las memorias y los dispositivos de E/S." },
            { tipo: 'cerrada', q: "El 'spool' o carrete de impresión es un ejemplo de:", opciones: ["Gestión de procesos de CPU.", "Almacenamiento temporal para evitar el caos en recursos compartidos.", "Un tipo de memoria RAM.", "Un comando de BASH."], correcta: "Almacenamiento temporal para evitar el caos en recursos compartidos." },
            { tipo: 'cerrada', q: "¿Qué función del SO decide cuándo y por cuánto tiempo dedicar la CPU a un programa?", opciones: ["Programas.", "Recursos.", "Planificación.", "Protección."], correcta: "Planificación." },
            { tipo: 'cerrada', q: "La 'Asignación Estática' de recursos también se conoce como:", opciones: ["Asignación en común.", "Partición de recursos.", "Memoria virtual.", "Kernel híbrido."], correcta: "Partición de recursos." },
            { tipo: 'cerrada', q: "¿Cuál es una desventaja de la asignación estática de recursos?", opciones: ["Es demasiado rápida.", "Requiere mucha memoria RAM.", "Derroche de recursos e incapacidad de proveer recursos adicionales.", "Solo funciona en sistemas Unix."], correcta: "Derroche de recursos e incapacidad de proveer recursos adicionales." },
            { tipo: 'cerrada', q: "En la 'Asignación Dinámica', ¿cuándo se asignan los recursos?", opciones: ["Antes de que comience la ejecución.", "Al momento de instalar el SO.", "Cada vez que un programa los pide durante la ejecución.", "Solo cuando el usuario lo autoriza manualmente."], correcta: "Cada vez que un programa los pide durante la ejecución." },
            { tipo: 'cerrada', q: "¿Qué es el Kernel o Núcleo?", opciones: ["La interfaz gráfica del sistema.", "La parte del SO que permanece siempre en memoria principal.", "El procesador físico de la computadora.", "Un archivo de configuración de usuario."], correcta: "La parte del SO que permanece siempre en memoria principal." },
            { tipo: 'cerrada', q: "Un Kernel que ejecuta todos los servicios (drivers, gestión de memoria) en modo núcleo se llama:", opciones: ["Microkernel.", "Monolítico.", "Híbrido.", "Exokernel."], correcta: "Monolítico." },
            { tipo: 'cerrada', q: "¿Cuál es la característica principal de un Microkernel?", opciones: ["Es el más rápido de todos.", "Traslada la mayoría de los servicios al espacio de usuario para ganar estabilidad.", "No permite el uso de drivers externos.", "Es el que usa exclusivamente Windows 95."], correcta: "Traslada la mayoría de los servicios al espacio de usuario para ganar estabilidad." },
            { tipo: 'cerrada', q: "¿Qué arquitectura de Kernel utiliza Windows NT / Windows 11?", opciones: ["Monolítico puro.", "Microkernel puro.", "Híbrido.", "Exokernel."], correcta: "Híbrido." },
            { tipo: 'cerrada', q: "¿Qué arquitectura de Kernel permite que las aplicaciones accedan al hardware casi directamente con mínimas abstracciones?", opciones: ["Monolítico.", "Exokernel.", "Híbrido.", "Microkernel."], correcta: "Exokernel." },
            { tipo: 'cerrada', q: "En Windows 11, ¿qué componente permite la portabilidad entre diferentes plataformas de hardware?", opciones: ["El Registro.", "La HAL (Hardware Abstraction Layer).", "El Administrador de Tareas.", "El explorador de archivos."], correcta: "La HAL (Hardware Abstraction Layer)." },
            { tipo: 'cerrada', q: "¿Qué sucede si un driver falla en 'Modo Usuario' en Windows?", opciones: ["El sistema se reinicia inmediatamente.", "Se produce un Pantallazo Azul (BSOD).", "El sistema sigue funcionando y solo se cierra el proceso afectado.", "El hardware se daña físicamente."], correcta: "El sistema sigue funcionando y solo se cierra el proceso afectado." },
            { tipo: 'cerrada', q: "¿Qué sucede si un error ocurre en el 'Modo Núcleo' (Kernel Mode)?", opciones: ["Windows lo ignora.", "Se genera un error crítico de sistema (BSOD).", "El usuario puede corregirlo con el mouse.", "El error se guarda en la papelera de reciclaje."], correcta: "Se genera un error crítico de sistema (BSOD)." },
            { tipo: 'cerrada', q: "El 'Ejecutivo de Windows' se encarga de:", opciones: ["Dibujar las ventanas en pantalla.", "Servicios básicos como memoria virtual, procesos y seguridad.", "Compilar código de C++.", "Gestionar la conexión Wi-Fi únicamente."], correcta: "Servicios básicos como memoria virtual, procesos y seguridad." },

            // --- MÓDULO 2: GEOMETRÍA DEL DISCO Y HARDWARE ---
            { tipo: 'cerrada', q: "En un disco duro, ¿qué es un 'Plato'?", opciones: ["El cable que conecta el disco.", "Un disco circular con material magnético para guardar datos.", "El motor que hace girar el eje.", "Una partición lógica."], correcta: "Un disco circular con material magnético para guardar datos." },
            { tipo: 'cerrada', q: "¿Qué define a un 'Cilindro'?", opciones: ["Un sector defectuoso.", "El conjunto de todas las pistas con el mismo número en todos los platos.", "El espacio total del disco duro.", "La velocidad de rotación."], correcta: "El conjunto de todas las pistas con el mismo número en todos los platos." },
            { tipo: 'cerrada', q: "¿Cuántos bytes tiene un 'Sector' estándar de disco duro?", opciones: ["1024 bytes.", "256 bytes.", "512 bytes.", "2048 bytes."], correcta: "512 bytes." },
            { tipo: 'cerrada', q: "¿Qué es un 'Cluster'?", opciones: ["Un sector dañado.", "La unidad mínima de asignación de espacio que maneja el SO (unión de varios sectores).", "Un tipo de cable SATA.", "El brazo del cabezal."], correcta: "La unidad mínima de asignación de espacio que maneja el SO (unión de varios sectores)." },
            { tipo: 'cerrada', q: "¿En qué consiste el direccionamiento CHS?", opciones: ["Cilindro, Cabeza (Head), Sector.", "Canal, Host, Sistema.", "Código, Hardware, Software.", "Cluster, Head, Segmento."], correcta: "Cilindro, Cabeza (Head), Sector." },
            { tipo: 'cerrada', q: "¿Cuál es el límite máximo de capacidad del direccionamiento CHS?", opciones: ["2.2 TB.", "8.4 GB.", "512 MB.", "128 GB."], correcta: "8.4 GB." },
            { tipo: 'cerrada', q: "¿Qué es LBA (Logical Block Addressing)?", opciones: ["Un método que numera los sectores de forma secuencial (0, 1, 2...).", "Una marca de discos duros.", "Un virus de sector de arranque.", "Un cable de conexión rápida."], correcta: "Un método que numera los sectores de forma secuencial (0, 1, 2...)." },
            { tipo: 'cerrada', q: "¿Qué tecnología permite meter más sectores en las pistas exteriores de un disco?", opciones: ["LBA.", "CHS.", "ZBR (Zone Bit Recording).", "Interleaving."], correcta: "ZBR (Zone Bit Recording)." },
            { tipo: 'cerrada', q: "El 'Interleaving' o Intercalado se usaba para:", opciones: ["Aumentar la capacidad del disco.", "Sincronizar la velocidad del disco con la capacidad de procesamiento de la controladora.", "Formatear el disco en GPT.", "Conectar dos discos en RAID."], correcta: "Sincronizar la velocidad del disco con la capacidad de procesamiento de la controladora." },

            // --- MÓDULO 3: MBR VS GPT ---
            { tipo: 'cerrada', q: "¿Dónde se localiza físicamente el MBR?", opciones: ["En el último sector del disco.", "En el Sector 0 (LBA 0).", "En una partición oculta de Windows.", "En la memoria RAM."], correcta: "En el Sector 0 (LBA 0)." },
            { tipo: 'cerrada', q: "¿Cuántos bytes del MBR están reservados para el código de arranque (Master Boot Code)?", opciones: ["64 bytes.", "512 bytes.", "446 bytes.", "2 bytes."], correcta: "446 bytes." },
            { tipo: 'cerrada', q: "¿Cuántas particiones primarias permite como máximo el esquema MBR?", opciones: ["128.", "2.", "4.", "Ilimitadas."], correcta: "4." },
            { tipo: 'cerrada', q: "¿Cuál es el tamaño de la tabla de particiones en el MBR?", opciones: ["446 bytes.", "64 bytes.", "2 bytes.", "512 bytes."], correcta: "64 bytes." },
            { tipo: 'cerrada', q: "¿Qué valor hexadecimal identifica la firma de arranque válida en un MBR?", opciones: ["0xAA55.", "0x55AA.", "0x1234.", "0xFFFF."], correcta: "0x55AA." },
            { tipo: 'cerrada', q: "¿Cuál es el límite de capacidad de un disco con particiones MBR?", opciones: ["8.4 GB.", "2.2 TB.", "128 TB.", "1 PB."], correcta: "2.2 TB." },
            { tipo: 'cerrada', q: "¿Cuántas particiones permite el esquema GPT?", opciones: ["4.", "16.", "128.", "1024."], correcta: "128." },
            { tipo: 'cerrada', q: "¿Qué es el 'Protective MBR' en GPT?", opciones: ["Una copia de seguridad del MBR.", "Un sector 0 falso que evita que herramientas antiguas borren el disco GPT.", "El lugar donde se guarda la contraseña del disco.", "Un driver de Windows 11."], correcta: "Un sector 0 falso que evita que herramientas antiguas borren el disco GPT." },
            { tipo: 'cerrada', q: "¿Cuál es una ventaja de GPT sobre MBR respecto a la seguridad?", opciones: ["Cifra los datos automáticamente.", "Almacena copias de seguridad de la tabla de particiones al final del disco.", "No permite virus.", "Es más rápido para borrar archivos."], correcta: "Almacena copias de seguridad de la tabla de particiones al final del disco." },
            { tipo: 'cerrada', q: "¿Qué sistema de firmware es necesario para arrancar desde un disco GPT en modo nativo?", opciones: ["BIOS.", "CMOS.", "UEFI.", "DOS."], correcta: "UEFI." },
            { tipo: 'cerrada', q: "En el esquema GPT, ¿qué sectores (LBA) contienen la tabla de particiones primaria?", opciones: ["LBA 1 al 33.", "Solo el LBA 0.", "Los últimos 33 sectores del disco.", "LBA 100 en adelante."], correcta: "LBA 1 al 33." },
            { tipo: 'cerrada', q: "Al usar Rufus para una PC moderna, ¿qué sistema de destino se debe elegir?", opciones: ["BIOS (o CSM).", "UEFI (no CSM).", "MS-DOS.", "Apple M1."], correcta: "UEFI (no CSM)." },
            { tipo: 'cerrada', q: "¿Qué formato de archivo se recomienda para un LiveUSB booteable en una PC moderna?", opciones: ["NTFS.", "FAT32.", "EXT4.", "APFS."], correcta: "FAT32." },
            { tipo: 'cerrada', q: "¿Cuál es el tamaño de cluster recomendado por la guía para Rufus?", opciones: ["4096 bytes.", "32 Kilobytes.", "512 bytes.", "64 Megabytes."], correcta: "32 Kilobytes." },

            // --- MÓDULO 4: LA TERMINAL (BASH) ---
            { tipo: 'cerrada', q: "¿Qué es el Shell?", opciones: ["El núcleo del sistema.", "El intérprete de comandos que actúa como interfaz entre usuario y kernel.", "Un tipo de disco duro.", "Un permiso especial de Linux."], correcta: "El intérprete de comandos que actúa como interfaz entre usuario y kernel." },
            { tipo: 'cerrada', q: "¿Cuál es el descriptor de archivo para la 'Salida de Errores' (stderr)?", opciones: ["0.", "1.", "2.", "3."], correcta: "2." },
            { tipo: 'cerrada', q: "¿Qué descriptor de archivo corresponde al teclado (stdin)?", opciones: ["0.", "1.", "2.", "10."], correcta: "0." },
            { tipo: 'cerrada', q: "El operador '>' sirve para:", opciones: ["Añadir texto al final de un archivo.", "Sobrescribir el contenido de un archivo con la salida de un comando.", "Comparar si un número es mayor que otro.", "Borrar un archivo."], correcta: "Sobrescribir el contenido de un archivo con la salida de un comando." },
            { tipo: 'cerrada', q: "Si quiero añadir información a un archivo sin borrar lo que ya tiene, uso:", opciones: ["`>`", "`<`", "`>>`", "`|`"], correcta: "`>>`" },
            { tipo: 'cerrada', q: "¿Cómo se redireccionan los errores (stderr) a un archivo llamado errores.log?", opciones: ["`comando > errores.log`", "`comando 2> errores.log`", "`comando 1> errores.log`", "`comando &> errores.log`"], correcta: "`comando 2> errores.log`" },
            { tipo: 'cerrada', q: "¿Qué símbolo se usa para enviar la salida de un comando como entrada de otro (Tubería)?", opciones: ["`>`", "`&`", "`|`", "`$`"], correcta: "`|`" },
            { tipo: 'cerrada', q: "El comodín '?' en BASH representa:", opciones: ["Cualquier cantidad de caracteres.", "Exactamente un carácter cualquiera.", "Una pregunta al usuario.", "Un archivo oculto."], correcta: "Exactamente un carácter cualquiera." },
            { tipo: 'cerrada', q: "El comodín '*' representa:", opciones: ["Un solo carácter.", "Cero o más caracteres.", "Solo números.", "Solo extensiones de archivo."], correcta: "Cero o más caracteres." },
            { tipo: 'cerrada', q: "¿Qué hace el comando 'ls -la'?", opciones: ["Borra todos los archivos.", "Lista todos los archivos, incluyendo ocultos, en formato detallado.", "Cambia el nombre de la carpeta.", "Apaga la computadora."], correcta: "Lista todos los archivos, incluyendo ocultos, en formato detallado." },
            { tipo: 'cerrada', q: "El comando 'mkdir -p carpeta1/carpeta2' sirve para:", opciones: ["Borrar dos carpetas.", "Crear carpetas anidadas (crea la ruta completa).", "Dar permisos de administrador.", "Listar el contenido de carpeta2."], correcta: "Crear carpetas anidadas (crea la ruta completa)." },
            { tipo: 'cerrada', q: "Para borrar un directorio que NO está vacío se usa:", opciones: ["rmdir", "rm -r", "delete", "erase"], correcta: "rm -r" },
            { tipo: 'cerrada', q: "El comando 'cp' sirve para:", opciones: ["Cortar y pegar.", "Comparar archivos.", "Copiar archivos o directorios.", "Cambiar la contraseña."], correcta: "Copiar archivos o directorios." },
            { tipo: 'cerrada', q: "¿Qué comando se usa tanto para mover archivos como para renombrarlos?", opciones: ["rn", "mv", "cp", "move"], correcta: "mv" },
            { tipo: 'cerrada', q: "¿Qué comando muestra el contenido de un archivo y permite navegarlo (avanzar y retroceder)?", opciones: ["cat", "more", "less", "head"], correcta: "less" },
            { tipo: 'cerrada', q: "Para ver las últimas 10 líneas de un archivo se usa:", opciones: ["top", "tail", "head", "last"], correcta: "tail" },
            { tipo: 'cerrada', q: "¿Qué hace el comando 'grep \"hola\" archivo.txt'?", opciones: ["Borra la palabra \"hola\" del archivo.", "Busca y muestra las líneas que contienen la palabra \"hola\".", "Cuenta cuántas letras tiene la palabra \"hola\".", "Crea un archivo llamado \"hola\"."], correcta: "Busca y muestra las líneas que contienen la palabra \"hola\"." },
            { tipo: 'cerrada', q: "El comando 'wc -l archivo.txt' devuelve:", opciones: ["El tamaño en bytes.", "El número de palabras.", "El número de líneas.", "El nombre del archivo."], correcta: "El número de líneas." },
            { tipo: 'cerrada', q: "¿Cuál es la diferencia entre 'df' y 'du'?", opciones: ["df es para memoria RAM y du para disco.", "df muestra espacio libre en particiones y du espacio usado por archivos/carpetas.", "Son el mismo comando con diferente nombre.", "Uno es para Windows y otro para Linux."], correcta: "df muestra espacio libre en particiones y du espacio usado por archivos/carpetas." },
            { tipo: 'cerrada', q: "Para buscar un archivo por su nombre en todo el sistema se usa:", opciones: ["search", "locate", "find", "grep"], correcta: "find" },
            { tipo: 'cerrada', q: "El comando 'free -h' muestra información sobre:", opciones: ["Archivos gratuitos.", "Espacio libre en disco duro.", "Memoria RAM y Swap en formato legible.", "Tiempo de uso del sistema."], correcta: "Memoria RAM y Swap en formato legible." },
            { tipo: 'cerrada', q: "Para leer el manual de un comando se usa:", opciones: ["help", "info", "man", "guide"], correcta: "man" },

            // --- MÓDULO 5: PERMISOS Y USUARIOS ---
            { tipo: 'cerrada', q: "En los permisos 'rwxr-xr--', ¿qué permisos tiene el GRUPO?", opciones: ["rwx", "r-x", "r--", "Ninguno"], correcta: "r-x" },
            { tipo: 'cerrada', q: "¿Cuál es el valor numérico (octal) del permiso de 'Escritura' (w)?", opciones: ["4.", "2.", "1.", "7."], correcta: "2." },
            { tipo: 'cerrada', q: "¿Cuál es el valor numérico del permiso de 'Lectura' (r)?", opciones: ["1.", "2.", "4.", "6."], correcta: "4." },
            { tipo: 'cerrada', q: "Un archivo con permiso '755' significa:", opciones: ["Todos tienen permiso total.", "Dueño total, grupo y otros solo lectura y ejecución.", "Nadie puede escribir.", "El archivo es secreto."], correcta: "Dueño total, grupo y otros solo lectura y ejecución." },
            { tipo: 'cerrada', q: "El permiso '644' se traduce en modo simbólico como:", opciones: ["rwxr-xr-x", "rw-r--r--", "rwx------", "r--r--r--"], correcta: "rw-r--r--" },
            { tipo: 'cerrada', q: "¿Qué comando cambia el dueño de un archivo?", opciones: ["chmod", "chown", "chgrp", "passwd"], correcta: "chown" },
            { tipo: 'cerrada', q: "¿Cómo se representan los permisos del 'Dueño', 'Grupo' y 'Otros' en orden?", opciones: ["u, g, o.", "d, g, o.", "a, b, c.", "r, w, x."], correcta: "u, g, o." },
            { tipo: 'cerrada', q: "¿Qué hace 'chmod u+x archivo'?", opciones: ["Quita el permiso de ejecución al usuario.", "Añade el permiso de ejecución al usuario (dueño).", "Borra el archivo.", "Hace que el archivo sea del grupo \"x\"."], correcta: "Añade el permiso de ejecución al usuario (dueño)." },
            { tipo: 'cerrada', q: "Un 'Inodo' es una estructura que NO contiene:", opciones: ["El tamaño del archivo.", "La fecha de creación.", "El nombre del archivo.", "Los permisos."], correcta: "El nombre del archivo." },
            { tipo: 'cerrada', q: "¿Dónde se guarda el nombre de un archivo en Linux?", opciones: ["Dentro del inodo.", "En la estructura del directorio.", "En el sector de arranque.", "En la memoria RAM."], correcta: "En la estructura del directorio." },
            { tipo: 'cerrada', q: "El permiso especial SUID tiene un valor octal de:", opciones: ["1.", "2.", "4.", "7."], correcta: "4." },
            { tipo: 'cerrada', q: "¿Qué permite el SUID en un archivo ejecutable?", opciones: ["Que el archivo no se pueda borrar.", "Que el archivo se ejecute con los privilegios del dueño (ej. root).", "Que el archivo sea más rápido.", "Que solo el dueño lo vea."], correcta: "Que el archivo se ejecute con los privilegios del dueño (ej. root)." },
            { tipo: 'cerrada', q: "El valor octal del permiso especial 'Sticky Bit' es:", opciones: ["1.", "2.", "4.", "0."], correcta: "1." },
            { tipo: 'cerrada', q: "¿Para qué sirve el 'Sticky Bit' en una carpeta como /tmp?", opciones: ["Para que los archivos se peguen entre sí.", "Para que solo el dueño de un archivo pueda borrarlo, aunque otros tengan permiso de escritura en la carpeta.", "Para ocultar la carpeta.", "Para que la carpeta no se llene."], correcta: "Para que solo el dueño de un archivo pueda borrarlo, aunque otros tengan permiso de escritura en la carpeta." },
            { tipo: 'cerrada', q: "El permiso especial SGID (valor 2) hace que:", opciones: ["El programa corra con privilegios del grupo propietario.", "El programa se borre solo.", "El programa se comparta en red.", "El grupo no pueda entrar."], correcta: "El programa corra con privilegios del grupo propietario." },
            { tipo: 'cerrada', q: "¿Cómo se activa el Sticky Bit junto con permisos 777 en modo octal?", opciones: ["chmod 7771", "chmod 1777", "chmod 4777", "chmod 777"], correcta: "chmod 1777" },

            // --- MÓDULO 6: VARIABLES Y SCRIPTING ---
            { tipo: 'cerrada', q: "¿Qué variable almacena las rutas donde el sistema busca los ejecutables?", opciones: ["$HOME", "$USER", "$PATH", "$ROOT"], correcta: "$PATH" },
            { tipo: 'cerrada', q: "La variable $HOME apunta a:", opciones: ["La página de inicio de Google.", "El directorio personal del usuario actual.", "La raíz del disco duro.", "La carpeta de Windows."], correcta: "El directorio personal del usuario actual." },
            { tipo: 'cerrada', q: "¿Qué almacena la variable $USER?", opciones: ["La contraseña del usuario.", "El nombre del usuario que inició la sesión.", "El número de usuarios conectados.", "El tipo de teclado."], correcta: "El nombre del usuario que inició la sesión." },
            { tipo: 'cerrada', q: "Si ejecutas un comando y quieres saber si tuvo éxito, revisas la variable:", opciones: ["$$", "$!", "$?", "$0"], correcta: "$?" },
            { tipo: 'cerrada', q: "En la variable $?, ¿qué valor indica que el comando terminó EXITOSAMENTE?", opciones: ["1.", "127.", "0.", "-1."], correcta: "0." },
            { tipo: 'cerrada', q: "¿Qué almacena la variable $$?", opciones: ["El precio del software.", "El PID (ID de proceso) del shell actual.", "El nombre del script.", "La cantidad de dinero en la cuenta."], correcta: "El PID (ID de proceso) del shell actual." },
            { tipo: 'cerrada', q: "¿Cómo se llama la primera línea de un script (#!/bin/bash)?", opciones: ["Hash.", "Shebang.", "Header.", "Boot."], correcta: "Shebang." },
            { tipo: 'cerrada', q: "Para pedir una entrada de datos al usuario en un script se usa:", opciones: ["input", "get", "read", "scan"], correcta: "read" },
            { tipo: 'cerrada', q: "El bucle 'for f in *.txt' sirve para:", opciones: ["Borrar archivos de texto.", "Iterar sobre cada archivo que termine en .txt.", "Crear archivos de texto.", "Buscar la palabra \"txt\"."], correcta: "Iterar sobre cada archivo que termine en .txt." },
            { tipo: 'cerrada', q: "¿Qué comando se usa para imprimir texto en la terminal desde un script?", opciones: ["print", "write", "echo", "display"], correcta: "echo" },
            { tipo: 'cerrada', q: "El operador '&&' entre dos comandos significa:", opciones: ["Ejecuta el segundo solo si el primero falló.", "Ejecuta el segundo solo si el primero tuvo éxito.", "Ejecuta ambos al mismo tiempo.", "Borra ambos comandos."], correcta: "Ejecuta el segundo solo si el primero tuvo éxito." },
            { tipo: 'cerrada', q: "El operador '||' entre dos comandos significa:", opciones: ["Ejecuta el segundo solo si el primero falló.", "Ejecuta el segundo solo si el primero tuvo éxito.", "Es una tubería.", "No hace nada."], correcta: "Ejecuta el segundo solo si el primero falló." },
            { tipo: 'cerrada', q: "¿Qué comando se usa para comparar dos archivos línea por línea?", opciones: ["cmp", "diff", "grep", "wc"], correcta: "diff" },
            { tipo: 'cerrada', q: "¿Qué significa el permiso 'r-s--x--x'?", opciones: ["Tiene SUID activo y permiso de ejecución.", "Tiene Sticky Bit.", "El archivo es secreto.", "El grupo tiene permiso de escritura."], correcta: "Tiene SUID activo y permiso de ejecución." },
            { tipo: 'cerrada', q: "En la arquitectura de Windows, ¿qué es un 'Subsistema de Entorno'?", opciones: ["Un driver de video.", "Una capa que permite ejecutar aplicaciones de diferentes tipos (Win32, POSIX).", "El fondo de pantalla.", "El antivirus."], correcta: "Una capa que permite ejecutar aplicaciones de diferentes tipos (Win32, POSIX)." },
            { tipo: 'cerrada', q: "Cuál es la función del 'Administrador de Objetos' en Windows?", opciones: ["Dibujar iconos.", "Crear, gestionar y proteger recursos del sistema como procesos y archivos.", "Limpiar el registro.", "Gestionar la batería."], correcta: "Crear, gestionar y proteger recursos del sistema como procesos y archivos." },
            { tipo: 'cerrada', q: "¿Qué es la 'Memoria Virtual'?", opciones: ["Una memoria RAM que no existe.", "Técnica que usa el disco duro para simular tener más memoria RAM de la física.", "La memoria de la tarjeta de video.", "Un juego de computadora."], correcta: "Técnica que usa el disco duro para simular tener más memoria RAM de la física." },
            { tipo: 'cerrada', q: "El comando 'top' sirve para:", opciones: ["Ir al inicio de un archivo.", "Ver los procesos en tiempo real y el consumo de recursos.", "Ver el modelo de la CPU.", "Formatear el disco."], correcta: "Ver los procesos en tiempo real y el consumo de recursos." },
            { tipo: 'cerrada', q: "¿Qué significa 'Open Source' (Código Abierto) como en Linux?", opciones: ["Que es gratis para siempre.", "Que cualquier persona puede ver, modificar y distribuir el código fuente.", "Que no tiene seguridad.", "Que solo funciona en servidores."], correcta: "Que cualquier persona puede ver, modificar y distribuir el código fuente." },
            { tipo: 'cerrada', q: "¿Qué comando se usa para cambiar la contraseña de un usuario?", opciones: ["password", "chpass", "passwd", "secret"], correcta: "passwd" },
            { tipo: 'cerrada', q: "¿Qué indica el símbolo '~' (virgulilla) en la ruta de la terminal?", opciones: ["Que estamos en la raíz del sistema.", "Que estamos en el directorio Home del usuario.", "Que hay un error en la ruta.", "Que el disco está lleno."], correcta: "Que estamos en el directorio Home del usuario." },
            { tipo: 'cerrada', q: "Si un disco GPT tiene el LBA 0 ocupado por el 'Protective MBR', ¿dónde empieza la cabecera real de GPT?", opciones: ["LBA 0.", "LBA 1.", "LBA 34.", "LBA 512."], correcta: "LBA 1." }
        ];

        let preguntasSeleccionadas = [];
        let indicePregunta = 0;
        let buenas = 0;
        let tiempo = 30;
        let cronometro;
        let cantidadDeseada = 10;

        window.onload = () => {
            document.getElementById('info-max').innerText = `Disponibles: ${bancoPreguntas.length}`;
        };

        function shuffle(array) {
            return array.sort(() => Math.random() - 0.5);
        }

        function prepararQuiz() {
            let input = document.getElementById('num-preguntas');
            let valor = parseInt(input.value);
            if (isNaN(valor) || valor < 5) { alert("Mínimo 5"); return; }
            cantidadDeseada = Math.min(valor, bancoPreguntas.length);
            iniciarQuiz();
        }

        function iniciarQuiz() {
            preguntasSeleccionadas = shuffle([...bancoPreguntas]).slice(0, cantidadDeseada);
            indicePregunta = 0; buenas = 0; historial = [];
            document.getElementById('config-area').style.display = 'none';
            document.getElementById('game-area').style.display = 'block';
            document.getElementById('result-area').style.display = 'none';
            mostrarPregunta();
        }

        function mostrarPregunta() {
            clearInterval(cronometro);
            tiempo = 30;
            actualizarInterfaz();
            
            const p = preguntasSeleccionadas[indicePregunta];
            document.getElementById('pregunta-texto').innerText = p.q;
            
            const optionsCont = document.getElementById('options-container');
            optionsCont.innerHTML = '';
            
            shuffle([...p.opciones]).forEach(opt => {
                const btn = document.createElement('button');
                btn.className = 'opcion-btn';
                btn.innerText = opt;
                btn.onclick = () => validarRespuesta(opt);
                optionsCont.appendChild(btn);
            });
            iniciarTimer();
        }

        function iniciarTimer() {
            cronometro = setInterval(() => {
                tiempo--;
                document.getElementById('timer').innerText = `${tiempo}s`;
                if (tiempo <= 0) validarRespuesta("Tiempo agotado");
            }, 1000);
        }

        function validarRespuesta(resp) {
            clearInterval(cronometro);
            const p = preguntasSeleccionadas[indicePregunta];
            const ok = (resp === p.correcta);
            if (ok) buenas++;
            historial.push({ q: p.q, c: p.correcta, ok: ok, r: resp });
            
            indicePregunta++;
            if (indicePregunta < cantidadDeseada) mostrarPregunta();
            else finalizarQuiz();
        }

        function finalizarQuiz() {
            document.getElementById('game-area').style.display = 'none';
            document.getElementById('result-area').style.display = 'block';
            document.getElementById('puntaje-texto').innerText = `Puntaje: ${buenas} / ${cantidadDeseada}`;
            
            const repaso = document.getElementById('repaso-container');
            repaso.innerHTML = historial.map((item, i) => `
                <div>
                    <strong>${i+1}. ${item.ok ? '✅' : '❌'}</strong> ${item.q}<br>
                    <small>Tu respuesta: ${item.r}</small><br>
                    ${!item.ok ? `<small style="color:green">Correcta: ${item.c}</small>` : ''}
                </div>
            `).join('');
        }

        function actualizarInterfaz() {
            document.getElementById('timer').innerText = `${tiempo}s`;
            document.getElementById('progress').innerText = `${indicePregunta + 1}/${cantidadDeseada}`;
        }
    </script>
</body>
</html>